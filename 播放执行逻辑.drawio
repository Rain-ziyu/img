<mxfile host="app.diagrams.net" modified="2024-03-12T06:48:36.636Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" etag="qjNsZEvz9Sx1tG0E4ow_" version="23.1.0" type="github">
  <diagram name="第 1 页" id="tmRrwLIW6BtaQIeTCq7Z">
    <mxGraphModel dx="2261" dy="786" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-1" value="PlayController" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="-50" y="70" width="100" height="1350" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-59" value="" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="6ezRHixvFWw8Gi5DJeS2-1">
          <mxGeometry x="45" y="250" width="10" height="1060" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-2" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;Inter&#39;;font-size:9.8pt;&quot;&gt;PlayServiceImpl&lt;/pre&gt;&lt;/div&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="100" y="70" width="100" height="1310" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-5" value="" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="6ezRHixvFWw8Gi5DJeS2-2">
          <mxGeometry x="45" y="80" width="10" height="510" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-15" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="6ezRHixvFWw8Gi5DJeS2-2" source="6ezRHixvFWw8Gi5DJeS2-5">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="55" y="190" as="sourcePoint" />
            <mxPoint x="55" y="210" as="targetPoint" />
            <Array as="points">
              <mxPoint x="110" y="170" />
              <mxPoint x="110" y="210" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-18" value="" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="6ezRHixvFWw8Gi5DJeS2-2">
          <mxGeometry x="40" y="280" width="20" height="170" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-19" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="6ezRHixvFWw8Gi5DJeS2-2" source="6ezRHixvFWw8Gi5DJeS2-18" target="6ezRHixvFWw8Gi5DJeS2-18">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="230" y="340" as="sourcePoint" />
            <mxPoint x="390" y="340" as="targetPoint" />
            <Array as="points">
              <mxPoint x="120" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-49" value="" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="6ezRHixvFWw8Gi5DJeS2-2">
          <mxGeometry x="45" y="930" width="10" height="180" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-3" value="调用play方法" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint y="160" as="sourcePoint" />
            <mxPoint x="150" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-4" value="Mysql" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="1060" y="70" width="100" height="510" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-6" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" source="6ezRHixvFWw8Gi5DJeS2-7" target="6ezRHixvFWw8Gi5DJeS2-4">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="155" y="170" as="sourcePoint" />
            <mxPoint x="250" y="170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="150" y="170" />
              <mxPoint x="220" y="170" />
              <mxPoint x="270" y="170" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-8" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" target="6ezRHixvFWw8Gi5DJeS2-7">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="155" y="170" as="sourcePoint" />
            <mxPoint x="310" y="170" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-7" value="查询IOT设备信息" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="155" y="170" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-9" value="Redis" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="1191" y="70" width="100" height="510" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-10" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" target="6ezRHixvFWw8Gi5DJeS2-9">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="155" y="220" as="sourcePoint" />
            <mxPoint x="449.5" y="220" as="targetPoint" />
            <Array as="points">
              <mxPoint x="270" y="220" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-11" value="查询缓存中是否创建过Stream通道" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="180" y="208" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-13" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot; face=&quot;Helvetica&quot;&gt;DeferredResultHolder&lt;/font&gt;&lt;/pre&gt;&lt;/div&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="380" y="70" width="100" height="1340" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-14" value="将DeferredResult放入Holder" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint x="155" y="314.5" as="sourcePoint" />
            <mxPoint x="435" y="314.5" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-16" value="生成一个DeferredResult&lt;br&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="185" y="245" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-17" value="其实内部是一个Map，Key存的是一个UUID &lt;br&gt;value就是DeferredResult" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="164" y="310" width="250" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-20" value="为DeferredResult设置&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;超时绑定以及完成时绑定" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="205" y="365" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-22" value="超时绑定用于当一分钟之内，&lt;br&gt;DeferredResult中仍然没有结果，&lt;br&gt;那么我们直接返回请求超时" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="200" y="405" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-23" value="完成时绑定用于当DeferredResult&lt;br&gt;中的Result为正常返回时，执行&lt;br&gt;基于RTSP推流的截图" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="200" y="450" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-25" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:11.3pt;&quot;&gt;SIPCommander&lt;/pre&gt;&lt;/div&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="550" y="70" width="100" height="740" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-26" value="调用SIPCommander向IOT设备发送SDP请求" style="endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;rounded=0;" edge="1" parent="1" source="6ezRHixvFWw8Gi5DJeS2-5" target="6ezRHixvFWw8Gi5DJeS2-25">
          <mxGeometry x="-1" y="3" relative="1" as="geometry">
            <mxPoint x="330" y="390" as="sourcePoint" />
            <mxPoint x="490" y="390" as="targetPoint" />
            <Array as="points">
              <mxPoint x="470" y="560" />
              <mxPoint x="470" y="560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-27" value="IOT设备" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="1340" y="70" width="100" height="1350" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-28" value="根据SIP协议的规定生成SIP的请求行以及请求头" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;curved=0;rounded=0;" edge="1" parent="1" target="6ezRHixvFWw8Gi5DJeS2-27">
          <mxGeometry x="-0.4068" y="10" width="60" relative="1" as="geometry">
            <mxPoint x="599.5" y="675" as="sourcePoint" />
            <mxPoint x="1209.5" y="675" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-30" value="在请求体中根据SDP的形式，写入流媒体服务器的IP地址、&lt;br&gt;端口号以及Ssrc即流编号&lt;div style=&quot;font-size: medium; text-align: start;&quot; data-hash=&quot;d9100ed9ce46d7371fa2b8870e2a03c1&quot; data-version=&quot;3.0.0&quot;&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="645" y="670" width="340" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-32" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:11.3pt;&quot;&gt;ZLMHttpHookSubscribe&lt;/pre&gt;&lt;/div&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="670" y="70" width="170" height="1040" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-33" value="内部其实一个ConcurrentHashMap" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;rounded=0;" edge="1" parent="1">
          <mxGeometry x="-1" relative="1" as="geometry">
            <mxPoint x="600" y="600" as="sourcePoint" />
            <mxPoint x="760" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-34" value="调用" style="edgeLabel;resizable=0;html=1;align=left;verticalAlign=bottom;" connectable="0" vertex="1" parent="6ezRHixvFWw8Gi5DJeS2-33">
          <mxGeometry x="-1" relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-35" value="并传递了两个回调事件" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="164" y="560" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-36" value="一个ZLMHttpHookSubscribe.Event的事件" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="150" y="580" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-37" value="一个SipSubscribe.Event的事件" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="155" y="598" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-38" value="Key是on_stream_changed类型" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="590" y="610" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-39" value="流媒体服务器" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="1510" y="70" width="100" height="910" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-40" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" target="6ezRHixvFWw8Gi5DJeS2-39">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1390" y="740" as="sourcePoint" />
            <mxPoint x="1379.5" y="740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-41" value="IOT设备根据SIP请求的内容向流媒体服务器开始推流" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1310" y="700" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-42" value="流媒体设备接收到摄像头的推流开始进行HTTP回调" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0.49;entryY=0.825;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1">
          <mxGeometry x="-0.0008" width="80" relative="1" as="geometry">
            <mxPoint x="1559.5" y="880" as="sourcePoint" />
            <mxPoint x="959" y="880" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-43" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:11.3pt;&quot;&gt;ZLMHttpHookListener&lt;/pre&gt;&lt;/div&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="910" y="70" width="100" height="1060" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-44" value="在我们被回调的Http接口中，&lt;br&gt;会调用ZLMHttpHookSubscribe" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint x="959.5" y="900" as="sourcePoint" />
            <mxPoint x="754.5" y="900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-45" value="把之前放入的ZLMHttpHookSubscribe.Event&lt;br&gt;的事件取出来" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry x="-0.361" y="-30" width="80" relative="1" as="geometry">
            <mxPoint x="754.5" y="940" as="sourcePoint" />
            <mxPoint x="959.5" y="940" as="targetPoint" />
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-47" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" source="6ezRHixvFWw8Gi5DJeS2-43" target="6ezRHixvFWw8Gi5DJeS2-2">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="949.5" y="1020" as="sourcePoint" />
            <mxPoint x="540" y="1020" as="targetPoint" />
            <Array as="points">
              <mxPoint x="530" y="1020" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-48" value="调用Event中的回调方法" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="330" y="1000" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-52" value="&lt;div style=&quot;background-color:#ffffff;color:#080808&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:11.3pt;&quot;&gt;调用onPublishHandlerForPlay方法、基于鉴权参数&lt;/pre&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:11.3pt;&quot;&gt;生成streamInfo，并在Redis中放入开始播放的缓存、存储通道信息流信息等&lt;/pre&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="205" y="1020" width="550" height="90" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-53" value="并携带流媒体服务器携带过来的鉴权参数内容" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="500" y="998" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-51" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" source="6ezRHixvFWw8Gi5DJeS2-49">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="155" y="1100" as="sourcePoint" />
            <mxPoint x="155" y="1120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="250" y="1060" />
              <mxPoint x="250" y="1120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-55" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1" source="6ezRHixvFWw8Gi5DJeS2-49" target="6ezRHixvFWw8Gi5DJeS2-13">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="410" y="1300" as="sourcePoint" />
            <mxPoint x="570" y="1300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="290" y="1150" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-56" value="调用DeferredResultHolder的invokeResult方法&lt;span style=&quot;background-color: initial;&quot;&gt;，&lt;br&gt;将StreamInfo等信息放到&lt;/span&gt;DeferredResult" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="160" y="1130" width="280" height="40" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-57" value="" style="endArrow=open;endFill=1;endSize=12;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="145.5" y="329.5" as="sourcePoint" />
            <mxPoint y="329.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-58" value="Return这个DeferredResult" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-10" y="300" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-60" value="但是并不是直接返回" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-70" y="488" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-61" value="DeferredResult会等待一分钟&lt;br&gt;如果一分钟之内有其他线程&lt;br&gt;调用了setResult方法，&lt;br&gt;那么执行OnComplate方法，&lt;br&gt;并返回Result中的信息&lt;br&gt;否则执行超时逻辑" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-90" y="590" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-62" value="" style="html=1;points=[[0,0,0,0,5],[0,1,0,0,-5],[1,0,0,0,5],[1,1,0,0,-5]];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};" vertex="1" parent="1">
          <mxGeometry x="425" y="1140" width="10" height="120" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-64" value="setResult方法调用之后，触发onCompletion方法" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry x="0.0576" y="10" width="80" relative="1" as="geometry">
            <mxPoint x="425" y="1210" as="sourcePoint" />
            <mxPoint x="-0.5" y="1210" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-65" value="" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;curved&quot;:0,&quot;rounded&quot;:0};participant=umlActor;" vertex="1" parent="1">
          <mxGeometry x="-240" y="80" width="20" height="1380" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-66" value="客户端Http请求" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;curved=0;rounded=0;" edge="1" parent="1">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint x="-230" y="130" as="sourcePoint" />
            <mxPoint y="130" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-67" value="1" style="endArrow=open;html=1;endSize=12;startArrow=diamondThin;startSize=14;startFill=0;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=bottom;rounded=0;" edge="1" parent="1">
          <mxGeometry x="-1" y="3" relative="1" as="geometry">
            <mxPoint x="-5" y="1370" as="sourcePoint" />
            <mxPoint x="-230.5" y="1370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-170" y="1370" />
              <mxPoint x="-170" y="1370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-68" value="Http请求返回" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-190" y="1350" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-69" value="携带RTSP、WS-FLV等多种播放地址返回" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-240" y="1380" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-72" value="针对返回的RTP流完成截图操作" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;" edge="1" parent="1" target="6ezRHixvFWw8Gi5DJeS2-27">
          <mxGeometry x="-0.8634" width="80" relative="1" as="geometry">
            <mxPoint x="5.5" y="1350" as="sourcePoint" />
            <mxPoint x="1390" y="1340" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="6ezRHixvFWw8Gi5DJeS2-73" value="用于前端页面的列表展示" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="240" y="1328" width="160" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
